<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
  <title>Live Views</title>
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <style>
    body{
      font-family: 'Inter', sans-serif;
      background:#fff;
      color:#000;
      margin:0;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:center;
      height:100vh;
    }
    .num{
      font-size:60px;
      font-weight:700;
      line-height:1.2;
      margin:10px 0;
    }
  </style>
</head>
<body>
  <div id="today" class="num">0</div>
  <div id="yesterday" class="num">0</div>

  <script>
    const socket = io("https://three23p-backend.onrender.com");
    const todayEl = document.getElementById("today");
    const yestEl = document.getElementById("yesterday");

    async function updateViews(){
      try{
        const res = await fetch("https://three23p-backend.onrender.com/api/views-readonly");
        const data = await res.json();
        todayEl.textContent = data.today.toLocaleString();
        yestEl.textContent = data.yesterday.toLocaleString();
      }catch{
        todayEl.textContent = "0";
        yestEl.textContent = "0";
      }
    }

    updateViews();
    setInterval(updateViews, 5000);

    socket.on("viewUpdate", v => {
      if (v.today !== undefined)
        todayEl.textContent = v.today.toLocaleString();
      if (v.yesterday !== undefined)
        yestEl.textContent = v.yesterday.toLocaleString();
    });
  </script>
</body>
</html>